
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Arrow Flight &#8212; Apache Arrow Java Cookbook  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Dataset" href="dataset.html" />
    <link rel="prev" title="Data manipulation" href="data.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="arrow-flight">
<h1><a class="toc-backref" href="#id1">Arrow Flight</a><a class="headerlink" href="#arrow-flight" title="Permalink to this headline">¶</a></h1>
<p>This section contains a number of recipes for working with Arrow Flight.
For more detail about Flight please take a look at <a class="reference internal" href="#arrow-flight-rpc">Arrow Flight RPC</a>.</p>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#arrow-flight" id="id1">Arrow Flight</a></p>
<ul>
<li><p><a class="reference internal" href="#simple-key-value-storage-service-with-arrow-flight" id="id2">Simple Key-Value Storage Service with Arrow Flight</a></p>
<ul>
<li><p><a class="reference internal" href="#flight-client-and-server" id="id3">Flight Client and Server</a></p></li>
<li><p><a class="reference internal" href="#start-flight-server" id="id4">Start Flight Server</a></p></li>
<li><p><a class="reference internal" href="#connect-to-flight-server" id="id5">Connect to Flight Server</a></p></li>
<li><p><a class="reference internal" href="#put-data" id="id6">Put Data</a></p></li>
<li><p><a class="reference internal" href="#get-metadata" id="id7">Get Metadata</a></p></li>
<li><p><a class="reference internal" href="#get-data" id="id8">Get Data</a></p></li>
<li><p><a class="reference internal" href="#delete-data" id="id9">Delete data</a></p></li>
<li><p><a class="reference internal" href="#validate-delete-data" id="id10">Validate Delete Data</a></p></li>
<li><p><a class="reference internal" href="#stop-flight-server" id="id11">Stop Flight Server</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<section id="simple-key-value-storage-service-with-arrow-flight">
<h2><a class="toc-backref" href="#id2">Simple Key-Value Storage Service with Arrow Flight</a><a class="headerlink" href="#simple-key-value-storage-service-with-arrow-flight" title="Permalink to this headline">¶</a></h2>
<p>We’ll implement a service that provides a key-value store for data, using Flight to handle uploads/requests
and data in memory to store the actual data.</p>
<section id="flight-client-and-server">
<h3><a class="toc-backref" href="#id3">Flight Client and Server</a><a class="headerlink" href="#flight-client-and-server" title="Permalink to this headline">¶</a></h3>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.apache.arrow.flight.Action</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.arrow.flight.AsyncPutListener</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.arrow.flight.CallStatus</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.arrow.flight.Criteria</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.arrow.flight.FlightClient</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.arrow.flight.FlightDescriptor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.arrow.flight.FlightEndpoint</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.arrow.flight.FlightInfo</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.arrow.flight.FlightServer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.arrow.flight.FlightStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.arrow.flight.Location</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.arrow.flight.NoOpFlightProducer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.arrow.flight.PutResult</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.arrow.flight.Result</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.arrow.flight.Ticket</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.arrow.memory.RootAllocator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.arrow.vector.VarCharVector</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.arrow.vector.VectorLoader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.arrow.vector.VectorSchemaRoot</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.arrow.vector.VectorUnloader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.arrow.vector.ipc.message.ArrowRecordBatch</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.arrow.vector.types.pojo.ArrowType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.arrow.vector.types.pojo.Field</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.arrow.vector.types.pojo.FieldType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.arrow.vector.types.pojo.Schema</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.charset.StandardCharsets</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Collections</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Iterator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.ConcurrentHashMap</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">Dataset</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">ArrowRecordBatch</span><span class="o">&gt;</span> <span class="n">batches</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Schema</span> <span class="n">schema</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">rows</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Dataset</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">ArrowRecordBatch</span><span class="o">&gt;</span> <span class="n">batches</span><span class="o">,</span> <span class="n">Schema</span> <span class="n">schema</span><span class="o">,</span> <span class="kt">long</span> <span class="n">rows</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">batches</span> <span class="o">=</span> <span class="n">batches</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">schema</span> <span class="o">=</span> <span class="n">schema</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">rows</span> <span class="o">=</span> <span class="n">rows</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">ArrowRecordBatch</span><span class="o">&gt;</span> <span class="nf">getBatches</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">batches</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">Schema</span> <span class="nf">getSchema</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">schema</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">getRows</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">rows</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">CookbookProducer</span> <span class="kd">extends</span> <span class="n">NoOpFlightProducer</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">RootAllocator</span> <span class="n">allocator</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Location</span> <span class="n">location</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">ConcurrentHashMap</span><span class="o">&lt;</span><span class="n">FlightDescriptor</span><span class="o">,</span> <span class="n">Dataset</span><span class="o">&gt;</span> <span class="n">datasets</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">CookbookProducer</span><span class="o">(</span><span class="n">RootAllocator</span> <span class="n">allocator</span><span class="o">,</span> <span class="n">Location</span> <span class="n">location</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">allocator</span> <span class="o">=</span> <span class="n">allocator</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">location</span> <span class="o">=</span> <span class="n">location</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">datasets</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ConcurrentHashMap</span><span class="o">&lt;&gt;();</span>
    <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Runnable</span> <span class="nf">acceptPut</span><span class="o">(</span><span class="n">CallContext</span> <span class="n">context</span><span class="o">,</span> <span class="n">FlightStream</span> <span class="n">flightStream</span><span class="o">,</span> <span class="n">StreamListener</span><span class="o">&lt;</span><span class="n">PutResult</span><span class="o">&gt;</span> <span class="n">ackStream</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">ArrowRecordBatch</span><span class="o">&gt;</span> <span class="n">batches</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
        <span class="k">return</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="kt">long</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="n">VectorUnloader</span> <span class="n">unloader</span><span class="o">;</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">flightStream</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">unloader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">VectorUnloader</span><span class="o">(</span><span class="n">flightStream</span><span class="o">.</span><span class="na">getRoot</span><span class="o">());</span>
                <span class="k">try</span> <span class="o">(</span><span class="kd">final</span> <span class="n">ArrowRecordBatch</span> <span class="n">arb</span> <span class="o">=</span> <span class="n">unloader</span><span class="o">.</span><span class="na">getRecordBatch</span><span class="o">())</span> <span class="o">{</span>
                    <span class="n">batches</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">arb</span><span class="o">);</span>
                    <span class="n">rows</span> <span class="o">+=</span> <span class="n">flightStream</span><span class="o">.</span><span class="na">getRoot</span><span class="o">().</span><span class="na">getRowCount</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="n">Dataset</span> <span class="n">dataset</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Dataset</span><span class="o">(</span><span class="n">batches</span><span class="o">,</span> <span class="n">flightStream</span><span class="o">.</span><span class="na">getSchema</span><span class="o">(),</span> <span class="n">rows</span><span class="o">);</span>
            <span class="n">datasets</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">flightStream</span><span class="o">.</span><span class="na">getDescriptor</span><span class="o">(),</span> <span class="n">dataset</span><span class="o">);</span>
            <span class="n">ackStream</span><span class="o">.</span><span class="na">onCompleted</span><span class="o">();</span>
        <span class="o">};</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">getStream</span><span class="o">(</span><span class="n">CallContext</span> <span class="n">context</span><span class="o">,</span> <span class="n">Ticket</span> <span class="n">ticket</span><span class="o">,</span> <span class="n">ServerStreamListener</span> <span class="n">listener</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">FlightDescriptor</span> <span class="n">flightDescriptor</span> <span class="o">=</span> <span class="n">FlightDescriptor</span><span class="o">.</span><span class="na">path</span><span class="o">(</span>
                <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">ticket</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(),</span> <span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>
        <span class="n">Dataset</span> <span class="n">dataset</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">datasets</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">flightDescriptor</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">dataset</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="n">CallStatus</span><span class="o">.</span><span class="na">NOT_FOUND</span><span class="o">.</span><span class="na">withDescription</span><span class="o">(</span><span class="s">&quot;Unknown descriptor&quot;</span><span class="o">).</span><span class="na">toRuntimeException</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">VectorSchemaRoot</span> <span class="n">vectorSchemaRoot</span> <span class="o">=</span> <span class="n">VectorSchemaRoot</span><span class="o">.</span><span class="na">create</span><span class="o">(</span>
                    <span class="k">this</span><span class="o">.</span><span class="na">datasets</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">flightDescriptor</span><span class="o">).</span><span class="na">getSchema</span><span class="o">(),</span> <span class="n">allocator</span><span class="o">);</span>
            <span class="n">listener</span><span class="o">.</span><span class="na">start</span><span class="o">(</span><span class="n">vectorSchemaRoot</span><span class="o">);</span>
            <span class="k">for</span> <span class="o">(</span><span class="n">ArrowRecordBatch</span> <span class="n">arrowRecordBatch</span> <span class="o">:</span> <span class="k">this</span><span class="o">.</span><span class="na">datasets</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">flightDescriptor</span><span class="o">).</span><span class="na">getBatches</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">VectorLoader</span> <span class="n">loader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">VectorLoader</span><span class="o">(</span><span class="n">vectorSchemaRoot</span><span class="o">);</span>
                <span class="n">loader</span><span class="o">.</span><span class="na">load</span><span class="o">(</span><span class="n">arrowRecordBatch</span><span class="o">.</span><span class="na">cloneWithTransfer</span><span class="o">(</span><span class="n">allocator</span><span class="o">));</span>
                <span class="n">listener</span><span class="o">.</span><span class="na">putNext</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="n">listener</span><span class="o">.</span><span class="na">completed</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doAction</span><span class="o">(</span><span class="n">CallContext</span> <span class="n">context</span><span class="o">,</span> <span class="n">Action</span> <span class="n">action</span><span class="o">,</span> <span class="n">StreamListener</span><span class="o">&lt;</span><span class="n">Result</span><span class="o">&gt;</span> <span class="n">listener</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">FlightDescriptor</span> <span class="n">flightDescriptor</span> <span class="o">=</span> <span class="n">FlightDescriptor</span><span class="o">.</span><span class="na">path</span><span class="o">(</span>
                <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">action</span><span class="o">.</span><span class="na">getBody</span><span class="o">(),</span> <span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>
        <span class="k">switch</span> <span class="o">(</span><span class="n">action</span><span class="o">.</span><span class="na">getType</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">case</span> <span class="s">&quot;DELETE&quot;</span><span class="o">:</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">datasets</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">flightDescriptor</span><span class="o">)</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">Result</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Result</span><span class="o">(</span><span class="s">&quot;Delete completed&quot;</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>
                    <span class="n">listener</span><span class="o">.</span><span class="na">onNext</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="n">Result</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Result</span><span class="o">(</span><span class="s">&quot;Delete not completed. Reason: Key did not exist.&quot;</span>
                            <span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>
                    <span class="n">listener</span><span class="o">.</span><span class="na">onNext</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
                <span class="o">}</span>
                <span class="n">listener</span><span class="o">.</span><span class="na">onCompleted</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">FlightInfo</span> <span class="nf">getFlightInfo</span><span class="o">(</span><span class="n">CallContext</span> <span class="n">context</span><span class="o">,</span> <span class="n">FlightDescriptor</span> <span class="n">descriptor</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">FlightEndpoint</span> <span class="n">flightEndpoint</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FlightEndpoint</span><span class="o">(</span>
                <span class="k">new</span> <span class="n">Ticket</span><span class="o">(</span><span class="n">descriptor</span><span class="o">.</span><span class="na">getPath</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">getBytes</span><span class="o">(</span><span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">)),</span> <span class="n">location</span><span class="o">);</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">FlightInfo</span><span class="o">(</span>
                <span class="n">datasets</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">descriptor</span><span class="o">).</span><span class="na">getSchema</span><span class="o">(),</span>
                <span class="n">descriptor</span><span class="o">,</span>
                <span class="n">Collections</span><span class="o">.</span><span class="na">singletonList</span><span class="o">(</span><span class="n">flightEndpoint</span><span class="o">),</span>
                <span class="cm">/*bytes=*/</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span>
                <span class="n">datasets</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">descriptor</span><span class="o">).</span><span class="na">getRows</span><span class="o">()</span>
        <span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">listFlights</span><span class="o">(</span><span class="n">CallContext</span> <span class="n">context</span><span class="o">,</span> <span class="n">Criteria</span> <span class="n">criteria</span><span class="o">,</span> <span class="n">StreamListener</span><span class="o">&lt;</span><span class="n">FlightInfo</span><span class="o">&gt;</span> <span class="n">listener</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">datasets</span><span class="o">.</span><span class="na">forEach</span><span class="o">((</span><span class="n">k</span><span class="o">,</span> <span class="n">v</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span> <span class="n">listener</span><span class="o">.</span><span class="na">onNext</span><span class="o">(</span><span class="n">getFlightInfo</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="n">k</span><span class="o">));</span> <span class="o">});</span>
        <span class="n">listener</span><span class="o">.</span><span class="na">onCompleted</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="n">Location</span> <span class="n">location</span> <span class="o">=</span> <span class="n">Location</span><span class="o">.</span><span class="na">forGrpcInsecure</span><span class="o">(</span><span class="s">&quot;0.0.0.0&quot;</span><span class="o">,</span> <span class="mi">33333</span><span class="o">);</span>
<span class="k">try</span> <span class="o">(</span><span class="n">RootAllocator</span> <span class="n">allocator</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RootAllocator</span><span class="o">(</span><span class="n">Long</span><span class="o">.</span><span class="na">MAX_VALUE</span><span class="o">)){</span>
    <span class="c1">// Server</span>
    <span class="k">try</span><span class="o">(</span><span class="n">FlightServer</span> <span class="n">flightServer</span> <span class="o">=</span> <span class="n">FlightServer</span><span class="o">.</span><span class="na">builder</span><span class="o">(</span><span class="n">allocator</span><span class="o">,</span> <span class="n">location</span><span class="o">,</span>
            <span class="k">new</span> <span class="n">CookbookProducer</span><span class="o">(</span><span class="n">allocator</span><span class="o">,</span> <span class="n">location</span><span class="o">)).</span><span class="na">build</span><span class="o">())</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">flightServer</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;S1: Server (Location): Listening on port &quot;</span> <span class="o">+</span> <span class="n">flightServer</span><span class="o">.</span><span class="na">getPort</span><span class="o">());</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="c1">// Client</span>
        <span class="k">try</span> <span class="o">(</span><span class="n">FlightClient</span> <span class="n">flightClient</span> <span class="o">=</span> <span class="n">FlightClient</span><span class="o">.</span><span class="na">builder</span><span class="o">(</span><span class="n">allocator</span><span class="o">,</span> <span class="n">location</span><span class="o">).</span><span class="na">build</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;C1: Client (Location): Connected to &quot;</span> <span class="o">+</span> <span class="n">location</span><span class="o">.</span><span class="na">getUri</span><span class="o">());</span>

            <span class="c1">// Populate data</span>
            <span class="n">Schema</span> <span class="n">schema</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Schema</span><span class="o">(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span>
                    <span class="k">new</span> <span class="n">Field</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">,</span> <span class="n">FieldType</span><span class="o">.</span><span class="na">nullable</span><span class="o">(</span><span class="k">new</span> <span class="n">ArrowType</span><span class="o">.</span><span class="na">Utf8</span><span class="o">()),</span> <span class="kc">null</span><span class="o">)));</span>
            <span class="k">try</span><span class="o">(</span><span class="n">VectorSchemaRoot</span> <span class="n">vectorSchemaRoot</span> <span class="o">=</span> <span class="n">VectorSchemaRoot</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">schema</span><span class="o">,</span> <span class="n">allocator</span><span class="o">);</span>
                <span class="n">VarCharVector</span> <span class="n">varCharVector</span> <span class="o">=</span> <span class="o">(</span><span class="n">VarCharVector</span><span class="o">)</span> <span class="n">vectorSchemaRoot</span><span class="o">.</span><span class="na">getVector</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">varCharVector</span><span class="o">.</span><span class="na">allocateNew</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
                <span class="n">varCharVector</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="s">&quot;Ronald&quot;</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>
                <span class="n">varCharVector</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s">&quot;David&quot;</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>
                <span class="n">varCharVector</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="s">&quot;Francisco&quot;</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>
                <span class="n">vectorSchemaRoot</span><span class="o">.</span><span class="na">setRowCount</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
                <span class="n">FlightClient</span><span class="o">.</span><span class="na">ClientStreamListener</span> <span class="n">listener</span> <span class="o">=</span> <span class="n">flightClient</span><span class="o">.</span><span class="na">startPut</span><span class="o">(</span>
                        <span class="n">FlightDescriptor</span><span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;profiles&quot;</span><span class="o">),</span>
                        <span class="n">vectorSchemaRoot</span><span class="o">,</span> <span class="k">new</span> <span class="n">AsyncPutListener</span><span class="o">());</span>
                <span class="n">listener</span><span class="o">.</span><span class="na">putNext</span><span class="o">();</span>
                <span class="n">varCharVector</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="s">&quot;Manuel&quot;</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>
                <span class="n">varCharVector</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s">&quot;Felipe&quot;</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>
                <span class="n">varCharVector</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="s">&quot;JJ&quot;</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>
                <span class="n">vectorSchemaRoot</span><span class="o">.</span><span class="na">setRowCount</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
                <span class="n">listener</span><span class="o">.</span><span class="na">putNext</span><span class="o">();</span>
                <span class="n">listener</span><span class="o">.</span><span class="na">completed</span><span class="o">();</span>
                <span class="n">listener</span><span class="o">.</span><span class="na">getResult</span><span class="o">();</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;C2: Client (Populate Data): Wrote 2 batches with 3 rows each&quot;</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="c1">// Get metadata information</span>
            <span class="n">FlightInfo</span> <span class="n">flightInfo</span> <span class="o">=</span> <span class="n">flightClient</span><span class="o">.</span><span class="na">getInfo</span><span class="o">(</span><span class="n">FlightDescriptor</span><span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;profiles&quot;</span><span class="o">));</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;C3: Client (Get Metadata): &quot;</span> <span class="o">+</span> <span class="n">flightInfo</span><span class="o">);</span>

            <span class="c1">// Get data information</span>
            <span class="k">try</span><span class="o">(</span><span class="n">FlightStream</span> <span class="n">flightStream</span> <span class="o">=</span> <span class="n">flightClient</span><span class="o">.</span><span class="na">getStream</span><span class="o">(</span><span class="k">new</span> <span class="n">Ticket</span><span class="o">(</span>
                    <span class="n">FlightDescriptor</span><span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;profiles&quot;</span><span class="o">).</span><span class="na">getPath</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">getBytes</span><span class="o">(</span><span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">))))</span> <span class="o">{</span>
                <span class="kt">int</span> <span class="n">batch</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
                <span class="k">try</span> <span class="o">(</span><span class="n">VectorSchemaRoot</span> <span class="n">vectorSchemaRootReceived</span> <span class="o">=</span> <span class="n">flightStream</span><span class="o">.</span><span class="na">getRoot</span><span class="o">())</span> <span class="o">{</span>
                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;C4: Client (Get Stream):&quot;</span><span class="o">);</span>
                    <span class="k">while</span> <span class="o">(</span><span class="n">flightStream</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
                        <span class="n">batch</span><span class="o">++;</span>
                        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Client Received batch #&quot;</span> <span class="o">+</span> <span class="n">batch</span> <span class="o">+</span> <span class="s">&quot;, Data:&quot;</span><span class="o">);</span>
                        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">vectorSchemaRootReceived</span><span class="o">.</span><span class="na">contentToTSVString</span><span class="o">());</span>
                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>

            <span class="c1">// Get all metadata information</span>
            <span class="n">Iterable</span><span class="o">&lt;</span><span class="n">FlightInfo</span><span class="o">&gt;</span> <span class="n">flightInfosBefore</span> <span class="o">=</span> <span class="n">flightClient</span><span class="o">.</span><span class="na">listFlights</span><span class="o">(</span><span class="n">Criteria</span><span class="o">.</span><span class="na">ALL</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">&quot;C5: Client (List Flights Info): &quot;</span><span class="o">);</span>
            <span class="n">flightInfosBefore</span><span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="n">t</span> <span class="o">-&gt;</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">t</span><span class="o">));</span>

            <span class="c1">// Do delete action</span>
            <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Result</span><span class="o">&gt;</span> <span class="n">deleteActionResult</span> <span class="o">=</span> <span class="n">flightClient</span><span class="o">.</span><span class="na">doAction</span><span class="o">(</span><span class="k">new</span> <span class="n">Action</span><span class="o">(</span><span class="s">&quot;DELETE&quot;</span><span class="o">,</span>
                    <span class="n">FlightDescriptor</span><span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;profiles&quot;</span><span class="o">).</span><span class="na">getPath</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">getBytes</span><span class="o">(</span><span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">)));</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">deleteActionResult</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">Result</span> <span class="n">result</span> <span class="o">=</span> <span class="n">deleteActionResult</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;C6: Client (Do Delete Action): &quot;</span> <span class="o">+</span>
                        <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">getBody</span><span class="o">(),</span> <span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>
            <span class="o">}</span>

            <span class="c1">// Get all metadata information (to validate detele action)</span>
            <span class="n">Iterable</span><span class="o">&lt;</span><span class="n">FlightInfo</span><span class="o">&gt;</span> <span class="n">flightInfos</span> <span class="o">=</span> <span class="n">flightClient</span><span class="o">.</span><span class="na">listFlights</span><span class="o">(</span><span class="n">Criteria</span><span class="o">.</span><span class="na">ALL</span><span class="o">);</span>
            <span class="n">flightInfos</span><span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="n">t</span> <span class="o">-&gt;</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">t</span><span class="o">));</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;C7: Client (List Flights Info): After delete - No records&quot;</span><span class="o">);</span>

            <span class="c1">// Server shut down</span>
            <span class="n">flightServer</span><span class="o">.</span><span class="na">shutdown</span><span class="o">();</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;C8: Server shut down successfully&quot;</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>S1: Server (Location): Listening on port 33333
C1: Client (Location): Connected to grpc+tcp://0.0.0.0:33333
C2: Client (Populate Data): Wrote 2 batches with 3 rows each
C3: Client (Get Metadata): FlightInfo{schema=Schema&lt;name: Utf8&gt;, descriptor=profiles, endpoints=[FlightEndpoint{locations=[Location{uri=grpc+tcp://0.0.0.0:33333}], ticket=org.apache.arrow.flight.Ticket@58871b0a}], bytes=-1, records=6}
C4: Client (Get Stream):
Client Received batch #1, Data:
name
Ronald
David
Francisco
Client Received batch #2, Data:
name
Manuel
Felipe
JJ
C5: Client (List Flights Info): FlightInfo{schema=Schema&lt;name: Utf8&gt;, descriptor=profiles, endpoints=[FlightEndpoint{locations=[Location{uri=grpc+tcp://0.0.0.0:33333}], ticket=org.apache.arrow.flight.Ticket@58871b0a}], bytes=-1, records=6}
C6: Client (Do Delete Action): Delete completed
C7: Client (List Flights Info): After delete - No records
C8: Server shut down successfully
</pre></div>
</div>
<p>Let explain our code in more detail.</p>
</section>
<section id="start-flight-server">
<h3><a class="toc-backref" href="#id4">Start Flight Server</a><a class="headerlink" href="#start-flight-server" title="Permalink to this headline">¶</a></h3>
<p>First, we’ll start our server:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="o">(</span><span class="n">FlightServer</span> <span class="n">flightServer</span> <span class="o">=</span> <span class="n">FlightServer</span><span class="o">.</span><span class="na">builder</span><span class="o">(</span><span class="n">allocator</span><span class="o">,</span> <span class="n">location</span><span class="o">,</span>
        <span class="k">new</span> <span class="n">CookbookProducer</span><span class="o">(</span><span class="n">allocator</span><span class="o">,</span> <span class="n">location</span><span class="o">)).</span><span class="na">build</span><span class="o">())</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">flightServer</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;S1: Server (Location): Listening on port &quot;</span> <span class="o">+</span> <span class="n">flightServer</span><span class="o">.</span><span class="na">getPort</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
</pre></div>
</div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>S1: Server <span class="o">(</span>Location<span class="o">)</span>: Listening on port <span class="m">33333</span>
</pre></div>
</div>
</section>
<section id="connect-to-flight-server">
<h3><a class="toc-backref" href="#id5">Connect to Flight Server</a><a class="headerlink" href="#connect-to-flight-server" title="Permalink to this headline">¶</a></h3>
<p>We can then create a client and connect to the server:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="k">try</span> <span class="o">(</span><span class="n">FlightClient</span> <span class="n">flightClient</span> <span class="o">=</span> <span class="n">FlightClient</span><span class="o">.</span><span class="na">builder</span><span class="o">(</span><span class="n">allocator</span><span class="o">,</span> <span class="n">location</span><span class="o">).</span><span class="na">build</span><span class="o">())</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;C1: Client (Location): Connected to &quot;</span> <span class="o">+</span> <span class="n">location</span><span class="o">.</span><span class="na">getUri</span><span class="o">());</span>
</pre></div>
</div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>C1: Client <span class="o">(</span>Location<span class="o">)</span>: Connected to grpc+tcp://0.0.0.0:33333
</pre></div>
</div>
</section>
<section id="put-data">
<h3><a class="toc-backref" href="#id6">Put Data</a><a class="headerlink" href="#put-data" title="Permalink to this headline">¶</a></h3>
<p>First, we’ll create and upload a vector schema root, which will get stored in a
memory by the server.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// Server</span>
<span class="kd">public</span> <span class="n">Runnable</span> <span class="nf">acceptPut</span><span class="o">(</span><span class="n">CallContext</span> <span class="n">context</span><span class="o">,</span> <span class="n">FlightStream</span> <span class="n">flightStream</span><span class="o">,</span> <span class="n">StreamListener</span><span class="o">&lt;</span><span class="n">PutResult</span><span class="o">&gt;</span> <span class="n">ackStream</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">ArrowRecordBatch</span><span class="o">&gt;</span> <span class="n">batches</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
    <span class="k">return</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="kt">long</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="n">VectorUnloader</span> <span class="n">unloader</span><span class="o">;</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">flightStream</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">unloader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">VectorUnloader</span><span class="o">(</span><span class="n">flightStream</span><span class="o">.</span><span class="na">getRoot</span><span class="o">());</span>
            <span class="k">try</span> <span class="o">(</span><span class="kd">final</span> <span class="n">ArrowRecordBatch</span> <span class="n">arb</span> <span class="o">=</span> <span class="n">unloader</span><span class="o">.</span><span class="na">getRecordBatch</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">batches</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">arb</span><span class="o">);</span>
                <span class="n">rows</span> <span class="o">+=</span> <span class="n">flightStream</span><span class="o">.</span><span class="na">getRoot</span><span class="o">().</span><span class="na">getRowCount</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="n">Dataset</span> <span class="n">dataset</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Dataset</span><span class="o">(</span><span class="n">batches</span><span class="o">,</span> <span class="n">flightStream</span><span class="o">.</span><span class="na">getSchema</span><span class="o">(),</span> <span class="n">rows</span><span class="o">);</span>
        <span class="n">datasets</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">flightStream</span><span class="o">.</span><span class="na">getDescriptor</span><span class="o">(),</span> <span class="n">dataset</span><span class="o">);</span>
        <span class="n">ackStream</span><span class="o">.</span><span class="na">onCompleted</span><span class="o">();</span>
    <span class="o">};</span>
<span class="o">}</span>

<span class="c1">// Client</span>
<span class="n">Schema</span> <span class="n">schema</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Schema</span><span class="o">(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span>
        <span class="k">new</span> <span class="n">Field</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">,</span> <span class="n">FieldType</span><span class="o">.</span><span class="na">nullable</span><span class="o">(</span><span class="k">new</span> <span class="n">ArrowType</span><span class="o">.</span><span class="na">Utf8</span><span class="o">()),</span> <span class="kc">null</span><span class="o">)));</span>
<span class="k">try</span><span class="o">(</span><span class="n">VectorSchemaRoot</span> <span class="n">vectorSchemaRoot</span> <span class="o">=</span> <span class="n">VectorSchemaRoot</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">schema</span><span class="o">,</span> <span class="n">allocator</span><span class="o">);</span>
    <span class="n">VarCharVector</span> <span class="n">varCharVector</span> <span class="o">=</span> <span class="o">(</span><span class="n">VarCharVector</span><span class="o">)</span> <span class="n">vectorSchemaRoot</span><span class="o">.</span><span class="na">getVector</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">))</span> <span class="o">{</span>
    <span class="n">varCharVector</span><span class="o">.</span><span class="na">allocateNew</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
    <span class="n">varCharVector</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="s">&quot;Ronald&quot;</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>
    <span class="n">varCharVector</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s">&quot;David&quot;</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>
    <span class="n">varCharVector</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="s">&quot;Francisco&quot;</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>
    <span class="n">vectorSchemaRoot</span><span class="o">.</span><span class="na">setRowCount</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
    <span class="n">FlightClient</span><span class="o">.</span><span class="na">ClientStreamListener</span> <span class="n">listener</span> <span class="o">=</span> <span class="n">flightClient</span><span class="o">.</span><span class="na">startPut</span><span class="o">(</span>
            <span class="n">FlightDescriptor</span><span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;profiles&quot;</span><span class="o">),</span>
            <span class="n">vectorSchemaRoot</span><span class="o">,</span> <span class="k">new</span> <span class="n">AsyncPutListener</span><span class="o">());</span>
    <span class="n">listener</span><span class="o">.</span><span class="na">putNext</span><span class="o">();</span>
    <span class="n">varCharVector</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="s">&quot;Manuel&quot;</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>
    <span class="n">varCharVector</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s">&quot;Felipe&quot;</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>
    <span class="n">varCharVector</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="s">&quot;JJ&quot;</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>
    <span class="n">vectorSchemaRoot</span><span class="o">.</span><span class="na">setRowCount</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
    <span class="n">listener</span><span class="o">.</span><span class="na">putNext</span><span class="o">();</span>
    <span class="n">listener</span><span class="o">.</span><span class="na">completed</span><span class="o">();</span>
    <span class="n">listener</span><span class="o">.</span><span class="na">getResult</span><span class="o">();</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;C2: Client (Populate Data): Wrote 2 batches with 3 rows each&quot;</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>C2: Client <span class="o">(</span>Populate Data<span class="o">)</span>: Wrote <span class="m">2</span> batches with <span class="m">3</span> rows each
</pre></div>
</div>
</section>
<section id="get-metadata">
<h3><a class="toc-backref" href="#id7">Get Metadata</a><a class="headerlink" href="#get-metadata" title="Permalink to this headline">¶</a></h3>
<p>Once we do so, we can retrieve the metadata for that dataset.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// Server</span>
<span class="kd">public</span> <span class="n">FlightInfo</span> <span class="nf">getFlightInfo</span><span class="o">(</span><span class="n">CallContext</span> <span class="n">context</span><span class="o">,</span> <span class="n">FlightDescriptor</span> <span class="n">descriptor</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">FlightEndpoint</span> <span class="n">flightEndpoint</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FlightEndpoint</span><span class="o">(</span>
            <span class="k">new</span> <span class="n">Ticket</span><span class="o">(</span><span class="n">descriptor</span><span class="o">.</span><span class="na">getPath</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">getBytes</span><span class="o">(</span><span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">)),</span> <span class="n">location</span><span class="o">);</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">FlightInfo</span><span class="o">(</span>
            <span class="n">datasets</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">descriptor</span><span class="o">).</span><span class="na">getSchema</span><span class="o">(),</span>
            <span class="n">descriptor</span><span class="o">,</span>
            <span class="n">Collections</span><span class="o">.</span><span class="na">singletonList</span><span class="o">(</span><span class="n">flightEndpoint</span><span class="o">),</span>
            <span class="cm">/*bytes=*/</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span>
            <span class="n">datasets</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">descriptor</span><span class="o">).</span><span class="na">getRows</span><span class="o">()</span>
    <span class="o">);</span>
<span class="o">}</span>

<span class="c1">// Client</span>
<span class="n">FlightInfo</span> <span class="n">flightInfo</span> <span class="o">=</span> <span class="n">flightClient</span><span class="o">.</span><span class="na">getInfo</span><span class="o">(</span><span class="n">FlightDescriptor</span><span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;profiles&quot;</span><span class="o">));</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;C3: Client (Get Metadata): &quot;</span> <span class="o">+</span> <span class="n">flightInfo</span><span class="o">);</span>
</pre></div>
</div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>C3: Client <span class="o">(</span>Get Metadata<span class="o">)</span>: FlightInfo<span class="o">{</span><span class="nv">schema</span><span class="o">=</span>Schema&lt;name: Utf8&gt;, <span class="nv">descriptor</span><span class="o">=</span>profiles, <span class="nv">endpoints</span><span class="o">=[</span>FlightEndpoint<span class="o">{</span><span class="nv">locations</span><span class="o">=[</span>Location<span class="o">{</span><span class="nv">uri</span><span class="o">=</span>grpc+tcp://0.0.0.0:33333<span class="o">}]</span>, <span class="nv">ticket</span><span class="o">=</span>org.apache.arrow.flight.Ticket@58871b0a<span class="o">}]</span>, <span class="nv">bytes</span><span class="o">=</span>-1, <span class="nv">records</span><span class="o">=</span><span class="m">6</span><span class="o">}</span>
</pre></div>
</div>
</section>
<section id="get-data">
<h3><a class="toc-backref" href="#id8">Get Data</a><a class="headerlink" href="#get-data" title="Permalink to this headline">¶</a></h3>
<p>And get the data back:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// Server</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">getStream</span><span class="o">(</span><span class="n">CallContext</span> <span class="n">context</span><span class="o">,</span> <span class="n">Ticket</span> <span class="n">ticket</span><span class="o">,</span> <span class="n">ServerStreamListener</span> <span class="n">listener</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">FlightDescriptor</span> <span class="n">flightDescriptor</span> <span class="o">=</span> <span class="n">FlightDescriptor</span><span class="o">.</span><span class="na">path</span><span class="o">(</span>
            <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">ticket</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(),</span> <span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>
    <span class="n">Dataset</span> <span class="n">dataset</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">datasets</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">flightDescriptor</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">dataset</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="n">CallStatus</span><span class="o">.</span><span class="na">NOT_FOUND</span><span class="o">.</span><span class="na">withDescription</span><span class="o">(</span><span class="s">&quot;Unknown descriptor&quot;</span><span class="o">).</span><span class="na">toRuntimeException</span><span class="o">();</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="n">VectorSchemaRoot</span> <span class="n">vectorSchemaRoot</span> <span class="o">=</span> <span class="n">VectorSchemaRoot</span><span class="o">.</span><span class="na">create</span><span class="o">(</span>
                <span class="k">this</span><span class="o">.</span><span class="na">datasets</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">flightDescriptor</span><span class="o">).</span><span class="na">getSchema</span><span class="o">(),</span> <span class="n">allocator</span><span class="o">);</span>
        <span class="n">listener</span><span class="o">.</span><span class="na">start</span><span class="o">(</span><span class="n">vectorSchemaRoot</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">ArrowRecordBatch</span> <span class="n">arrowRecordBatch</span> <span class="o">:</span> <span class="k">this</span><span class="o">.</span><span class="na">datasets</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">flightDescriptor</span><span class="o">).</span><span class="na">getBatches</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">VectorLoader</span> <span class="n">loader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">VectorLoader</span><span class="o">(</span><span class="n">vectorSchemaRoot</span><span class="o">);</span>
            <span class="n">loader</span><span class="o">.</span><span class="na">load</span><span class="o">(</span><span class="n">arrowRecordBatch</span><span class="o">.</span><span class="na">cloneWithTransfer</span><span class="o">(</span><span class="n">allocator</span><span class="o">));</span>
            <span class="n">listener</span><span class="o">.</span><span class="na">putNext</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="n">listener</span><span class="o">.</span><span class="na">completed</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// Client</span>
<span class="k">try</span><span class="o">(</span><span class="n">FlightStream</span> <span class="n">flightStream</span> <span class="o">=</span> <span class="n">flightClient</span><span class="o">.</span><span class="na">getStream</span><span class="o">(</span><span class="k">new</span> <span class="n">Ticket</span><span class="o">(</span>
        <span class="n">FlightDescriptor</span><span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;profiles&quot;</span><span class="o">).</span><span class="na">getPath</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">getBytes</span><span class="o">(</span><span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">))))</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">batch</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="k">try</span> <span class="o">(</span><span class="n">VectorSchemaRoot</span> <span class="n">vectorSchemaRootReceived</span> <span class="o">=</span> <span class="n">flightStream</span><span class="o">.</span><span class="na">getRoot</span><span class="o">())</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;C4: Client (Get Stream):&quot;</span><span class="o">);</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">flightStream</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">batch</span><span class="o">++;</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Client Received batch #&quot;</span> <span class="o">+</span> <span class="n">batch</span> <span class="o">+</span> <span class="s">&quot;, Data:&quot;</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">vectorSchemaRootReceived</span><span class="o">.</span><span class="na">contentToTSVString</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>C4: Client <span class="o">(</span>Get Stream<span class="o">)</span>:
Client Received batch <span class="c1">#1, Data:</span>
name
Ronald
David
Francisco
Client Received batch <span class="c1">#2, Data:</span>
name
Manuel
Felipe
JJ
</pre></div>
</div>
</section>
<section id="delete-data">
<h3><a class="toc-backref" href="#id9">Delete data</a><a class="headerlink" href="#delete-data" title="Permalink to this headline">¶</a></h3>
<p>Then, we’ll delete the dataset:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// Server</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">doAction</span><span class="o">(</span><span class="n">CallContext</span> <span class="n">context</span><span class="o">,</span> <span class="n">Action</span> <span class="n">action</span><span class="o">,</span> <span class="n">StreamListener</span><span class="o">&lt;</span><span class="n">Result</span><span class="o">&gt;</span> <span class="n">listener</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">FlightDescriptor</span> <span class="n">flightDescriptor</span> <span class="o">=</span> <span class="n">FlightDescriptor</span><span class="o">.</span><span class="na">path</span><span class="o">(</span>
            <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">action</span><span class="o">.</span><span class="na">getBody</span><span class="o">(),</span> <span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>
    <span class="k">switch</span> <span class="o">(</span><span class="n">action</span><span class="o">.</span><span class="na">getType</span><span class="o">())</span> <span class="o">{</span>
        <span class="k">case</span> <span class="s">&quot;DELETE&quot;</span><span class="o">:</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">datasets</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">flightDescriptor</span><span class="o">)</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">Result</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Result</span><span class="o">(</span><span class="s">&quot;Delete completed&quot;</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>
                <span class="n">listener</span><span class="o">.</span><span class="na">onNext</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="n">Result</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Result</span><span class="o">(</span><span class="s">&quot;Delete not completed. Reason: Key did not exist.&quot;</span>
                        <span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>
                <span class="n">listener</span><span class="o">.</span><span class="na">onNext</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="n">listener</span><span class="o">.</span><span class="na">onCompleted</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// Client</span>
<span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Result</span><span class="o">&gt;</span> <span class="n">deleteActionResult</span> <span class="o">=</span> <span class="n">flightClient</span><span class="o">.</span><span class="na">doAction</span><span class="o">(</span><span class="k">new</span> <span class="n">Action</span><span class="o">(</span><span class="s">&quot;DELETE&quot;</span><span class="o">,</span>
        <span class="n">FlightDescriptor</span><span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">&quot;profiles&quot;</span><span class="o">).</span><span class="na">getPath</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">getBytes</span><span class="o">(</span><span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">)));</span>
<span class="k">while</span> <span class="o">(</span><span class="n">deleteActionResult</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
    <span class="n">Result</span> <span class="n">result</span> <span class="o">=</span> <span class="n">deleteActionResult</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;C6: Client (Do Delete Action): &quot;</span> <span class="o">+</span>
            <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">getBody</span><span class="o">(),</span> <span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>C6: Client <span class="o">(</span>Do Delete Action<span class="o">)</span>: Delete completed
</pre></div>
</div>
</section>
<section id="validate-delete-data">
<h3><a class="toc-backref" href="#id10">Validate Delete Data</a><a class="headerlink" href="#validate-delete-data" title="Permalink to this headline">¶</a></h3>
<p>And confirm that it’s been deleted:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// Server</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">listFlights</span><span class="o">(</span><span class="n">CallContext</span> <span class="n">context</span><span class="o">,</span> <span class="n">Criteria</span> <span class="n">criteria</span><span class="o">,</span> <span class="n">StreamListener</span><span class="o">&lt;</span><span class="n">FlightInfo</span><span class="o">&gt;</span> <span class="n">listener</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">datasets</span><span class="o">.</span><span class="na">forEach</span><span class="o">((</span><span class="n">k</span><span class="o">,</span> <span class="n">v</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span> <span class="n">listener</span><span class="o">.</span><span class="na">onNext</span><span class="o">(</span><span class="n">getFlightInfo</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="n">k</span><span class="o">));</span> <span class="o">});</span>
    <span class="n">listener</span><span class="o">.</span><span class="na">onCompleted</span><span class="o">();</span>
<span class="o">}</span>

<span class="c1">// Client</span>
<span class="n">Iterable</span><span class="o">&lt;</span><span class="n">FlightInfo</span><span class="o">&gt;</span> <span class="n">flightInfos</span> <span class="o">=</span> <span class="n">flightClient</span><span class="o">.</span><span class="na">listFlights</span><span class="o">(</span><span class="n">Criteria</span><span class="o">.</span><span class="na">ALL</span><span class="o">);</span>
<span class="n">flightInfos</span><span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="n">t</span> <span class="o">-&gt;</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">t</span><span class="o">));</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;C7: Client (List Flights Info): After delete - No records&quot;</span><span class="o">);</span>
</pre></div>
</div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>C7: Client <span class="o">(</span>List Flights Info<span class="o">)</span>: After delete - No records
</pre></div>
</div>
</section>
<section id="stop-flight-server">
<h3><a class="toc-backref" href="#id11">Stop Flight Server</a><a class="headerlink" href="#stop-flight-server" title="Permalink to this headline">¶</a></h3>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// Server</span>
<span class="n">flightServer</span><span class="o">.</span><span class="na">shutdown</span><span class="o">();</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;C8: Server shut down successfully&quot;</span><span class="o">);</span>
</pre></div>
</div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>C8: Server shut down successfully
</pre></div>
</div>
<p><span class="target" id="arrow-flight-rpc">Arrow Flight RPC</span>: <a class="reference external" href="https://arrow.apache.org/docs/format/Flight.html">https://arrow.apache.org/docs/format/Flight.html</a></p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Apache Arrow Java Cookbook</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="create.html">Creating Arrow Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="io.html">Reading and writing data</a></li>
<li class="toctree-l1"><a class="reference internal" href="schema.html">Working with Schema</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Data manipulation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Arrow Flight</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#simple-key-value-storage-service-with-arrow-flight">Simple Key-Value Storage Service with Arrow Flight</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dataset.html">Dataset</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="data.html" title="previous chapter">Data manipulation</a></li>
      <li>Next: <a href="dataset.html" title="next chapter">Dataset</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Apache Software Foundation.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.5.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/flight.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>